flows:
  order_pizza:
    name: order pizza
    description: user asks for a pizza
    nlu_trigger:
    - intent:
        name: inform_pizza
        confidence_threshold: 0.5
    steps:
    - collect: pizza
    - collect: num_pizza
    - collect: address
    - collect: order_confirmation
      next:
        - if: slots.order_confirmation
          then: "place_order"
        - else: "cancel_order"
    - id: "place_order"
      action: utter_place_order
      next: END
    - id: "cancel_order"
      action: utter_cancel_order
      next: END

  authenticate_user:
    name: authenticate user
    description: user asks to authenticate
    steps:
      - collect: is_member
        next:
          - if: slots.is_member
            then: "login_successful"
          - else: "cancel_auth"
      - id: "login_successful"
        action: utter_login_successful
        next: END
      - id: "cancel_auth"
        action: utter_cancel_auth
        next: END

  payment_flow:
    name: payment flow
    description: user asks to pay for order
    nlu_trigger:
      - intent: request_payment
        confidence_threshold: 0.5
    steps:
      - collect: payment_option
        next:
          - if: slots.payment_option is 'card'
            then: "use_card_details"
          - else: "invalid_payment_option"
      - id: "use_card_details"
        collect: card_number
        next:
            - if: slots.card_number
              then: "take_payment"
            - else: "cancel_order"
      - id: "invalid_payment_option"
        action: utter_invalid_payment_option
        next: END
      - id: "take_payment"
        action: utter_execute_payment
        next: END
      - id: "cancel_order"
        action: utter_cancel_order
        next: END
